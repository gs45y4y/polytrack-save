<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
    <title>PolyTrack Storage</title>
    <script>
        (function() {
            const base = "https://cdn.jsdelivr.net/gh/genizy/polytrack@feb7f045e85fdf07e0d7f7e6d0f08984b9fe20d6/";
            const originalWorker = window.Worker;
            let blobUrl = null;

            fetch(base + "simulation_worker.bundle.js")
                .then(r => r.text())
                .then(t => {
                    const fixed = t.replaceAll("replacethisplease", base);
                    blobUrl = URL.createObjectURL(new Blob([fixed], { type: 'application/javascript' }));
                });

            window.Worker = function(url, opt) {
                if (typeof url === 'string' && url.includes("simulation_worker.bundle.js")) {
                    return new originalWorker(blobUrl || url, opt);
                }
                return new originalWorker(url, opt);
            };
            window.Worker.prototype = originalWorker.prototype;

            const origFetch = window.fetch;
            window.fetch = async function(i, n) {
                let u = (typeof i === "string") ? i : i.url;
                if (u.includes("vps.kodub.com")) {
                    u = u.replace("vps.kodub.com", "vpskodub.tmena1565.workers.dev");
                    i = (i instanceof Request) ? new Request(u, n) : u;
                }
                return origFetch(i, n);
            };
        })();
    </script>
    <script defer src="https://cdn.jsdelivr.net/gh/genizy/polytrack@feb7f045e85fdf07e0d7f7e6d0f08984b9fe20d6/error_screen.bundle.js"></script>
    <script defer src="https://cdn.jsdelivr.net/gh/genizy/polytrack@feb7f045e85fdf07e0d7f7e6d0f08984b9fe20d6/main.bundle.js"></script>
    <style>
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; background: #000; }
        #screen { width: 100vw; height: 100vh; display: block; }
    </style>
</head>
<body>
    <canvas id="screen"></canvas>
    <div id="ui"></div>
    <div id="transition-layer"></div>
</body>
</html>
